---
schemaVersion: 2.0.0

commandTests:
  - name: "ubuntu"
    command: "grep"
    args: ["DISTRIB_RELEASE", "/etc/lsb-release"]
    expectedOutput: ["DISTRIB_RELEASE=24.04"]

  - name: "curl"
    command: "bash"
    args:
      - "-lc"
      - "curl --version | awk 'NR==1{print $2}'"
    expectedOutput: ["8.5.0"]

  - name: "ping"
    command: "ping"
    args: ["-V"]
    expectedOutput: ["20240117"]

  - name: "netcat-openbsd"
    command: "bash"
    args:
      - "-lc"
      - "nc -h 2>&1 | head -n1"
    expectedOutput: ["OpenBSD netcat \\(Debian patchlevel 1\\.226-1ubuntu2\\)"]

metadataTest:
  labels:
    - key: "org.opencontainers.image.vendor"
      value: "Ministry of Justice"

    - key: "org.opencontainers.image.authors"
      value: "Analytical Platform (analytical-platform@digital.justice.gov.uk)"

    - key: "org.opencontainers.image.title"
      value: "Analytical Platform Network Diagnostics"

    - key: "org.opencontainers.image.description"
      value: "Minimal Ubuntu image with networking diagnostic tools installed"

    - key: "org.opencontainers.image.url"
      value: "https://github.com/ministryofjustice/analytical-platform-network-diagnostics"
